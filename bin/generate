#!/usr/bin/env node

// generate bucket
// generate table Foo
// generate function Foo preflight
// generate data_function Foo create
// generate api_collection_method Foo get index
// generate api_collection_method Foo get show
// generate crud_api Foo
//   - bucket
//   - table Foo id:string
//   - function Foo preflight
//   - data_function Foo create
//   - data_function Foo index
//   - data_function Foo show
//   - data_function Foo update
//   - data_function Foo destroy
//   - api_collection_method Foo options preflight
//   - api_collection_method Foo post create
//   - api_collection_method Foo get index
//   - api_member_method Foo options preflight
//   - api_member_method Foo get show
//   - api_member_method Foo put update
//   - api_member_method Foo patch update
//   - api_member_method Foo patch destroy

const { merge } = require('lodash');
const Template = require('../src/template');
const { generateCodeBucket, generateTable, generateFunction,
        generateDataFunction, generateApiCollectionMethod,
        generateApiMemberMethod } = require('../src/generators');

const resource = 'person';
const description = 'My API';

const templateDef = merge(
  {},

  Template({}, {}, description),

  generateCodeBucket(),

  generateTable(resource, 'ID', 'S'),

  generateFunction(resource, 'preflight'),
  generateDataFunction(resource, 'create'),
  generateDataFunction(resource, 'index'),
  generateDataFunction(resource, 'show'),
  generateDataFunction(resource, 'update'),
  generateDataFunction(resource, 'destroy'),

  generateApiCollectionMethod(resource, 'options', 'preflight'),
  generateApiCollectionMethod(resource, 'post', 'create'),
  generateApiCollectionMethod(resource, 'get', 'index'),
  generateApiMemberMethod(resource, 'get', 'show'),
  generateApiMemberMethod(resource, 'put', 'update'),
  generateApiMemberMethod(resource, 'patch', 'update'),
  generateApiMemberMethod(resource, 'delete', 'destroy')
);

console.log(JSON.stringify(templateDef, null, 2));
